var OVF=OVF||{};OVF.API=function(){var e={},t={},n=function(e,n,r,i){var s=new XMLHttpRequest;s.onreadystatechange=onreadystatechange=function(){s.readyState=="4"&&i(s.responseText)},s.open(e,t.url+n,!0),s.setRequestHeader("Accept","application/xml"),s.setRequestHeader("Content-Type","application/xml"),s.setRequestHeader("X-Auth-Token",t.token),s.send(r)};return e.configure=function(e,n){t.url=e+"/",t.token=n},e.createVDC=function(e){n("POST","vdc",e.toXML(),function(e){console.log(e)})},e.deleteVDC=function(e){n("DELETE","vdc/"+e,vdc.toXML(),function(e){console.log(e)})},e.getVDCs=function(e){n("GET","vdc",undefined,function(t){e(OVF.VDCs({}).fromXML(t))})},e.getVDC=function(e,t){n("GET","vdc/"+e,undefined,function(e){var n=OVF.VDC({});n.fromXML(e),t!==undefined&&t(n)})},e.createService=function(e,t){n("POST","vdc/"+e+"/services",t.instantiateOVF(),function(e){console.log(e)})},e.getServices=function(e,t){n("GET","vdc/"+e+"/services",undefined,function(e){t(OVF.Services({}).fromXML(e))})},e.getService=function(e,t,r){n("GET","vdc/"+e+"/services/"+t,undefined,function(e){r(e)})},e}();var OVF=OVF||{};OVF.Configuration=function(){var e={};return e.restHost="localhost",e.restPort="8182",e.organizationId="es.tid",e.vdcName="test",e}();var OVF=OVF||{},OVF=OVF||{};OVF.Network=function(){var e={};return e};var OVF=OVF||{};OVF.Service=function(e){"use strict";var t={};return t.servAppName="",t.networks=[],t.organizationId="",t.vdcName="",t.vms=[],t.kpis=[],t.rules=[],t.organizationId=OVF.Configuration.organizationId,t.vdcName=OVF.Configuration.vdcName,t.addVM=function(e){t.vms.push(e)},t.addNetwork=function(e){t.networks.push(e)},t.addServiceKPI=function(e){t.kpis.push(e)},t.instantiateOVF=function(){var e;return t.networks.length===0&&(e=OVF.Network(),e.name="gestion",e.publicNet=!1,t.addNetwork(e),e=OVF.Network(),e.name="public",e.publicNet=!0,t.addNetwork(e)),Utils.template("InstantiateServiceTemplate.xml",t)},t.getEnvelope=function(){var e;return t.networks.length===0&&(e=OVF.Network(),e.name="gestion",e.publicNet=!1,t.addNetwork(e),e=OVF.Network(),e.name="public",e.publicNet=!0,t.addNetwork(e)),t.vms.length===0?Utils.template("ServiceEmptyEnvelope.xml",t):Utils.template("ServiceScheleton.xml",t)},t};var OVF=OVF||{};OVF.Services=function(e){var t={},n=new X2JS;return t.toXML=function(){return'<?xml version="1.0" encoding="UTF-8"?>'+n.json2xml_str({Services:t})},t.fromXML=function(e){var t=n.xml_str2json(e).Services,r=t.service;return t.service instanceof Array||(t.service!==undefined?r=[t.service]:r=[]),r},t};var OVF=OVF||{};OVF.VDC=function(e){var t={},n=new X2JS;return t.Description=e.description,t._name=e.name,e.id!==undefined&&(t._Id=e.id),t.StorageCapacity={Disk:{Units:e.disk_units,Limit:e.disk_limit}},t.ComputeCapacity={Cpu:{Units:e.cpu_units,Limit:e.cpu_limit},Memory:{Units:e.memory_units,Limit:e.memory_limit}},t.addVirtualNetwork=function(e,n,r,i,s,o,u,a){t.Topology=t.Topology||{Zone:[]},t.Topology.Zone.push({_type:e,VirtualNetwork:{_id:n,_name:r,Description:i,Mode:s,Bandwidth:{_units:o,__text:u},Size:a}})},t.toXML=function(){return'<?xml version="1.0" encoding="UTF-8"?>'+n.json2xml_str({VDC:t})},t.fromXML=function(e){var r=n.xml_str2json(e).vdc;t._name=r._name,t._Id=r._Id,t.Topology=r.Topology,t.AvailableNetworks=r.AvailableNetworks,t.StorageCapacity=r.StorageCapacity,t.ComputeCapacity=r.ComputeCapacity,t.Description=r.Description},t};var OVF=OVF||{};OVF.VDCs=function(e){var t={},n=new X2JS;return t.toXML=function(){return'<?xml version="1.0" encoding="UTF-8"?>'+n.json2xml_str({VDCs:t})},t.fromXML=function(e){var t=n.xml_str2json(e).VDCs,r=t.vdc;return t.vdc instanceof Array||(t.vdc!==undefined?r=[t.vdc]:r=[]),r},t};var OVF=OVF||{};OVF.VM=function(){var e={};return e.isBalancer=!1,e.network="public",e.memory=512,e.cpu=1,e.version="1.0",e.VirtualizationTechnologyType={XEN:"XEN",VMWARE:"VMWARE",KVM:"KVM"},e.getVMEnvelope=function(){var t;return e.isBalancer?t="VMEnvelopeBalancer.xml":e.balancer!==undefined?t="VMEnvelopeBalanced.xml":t="VMEnvelope.xml",Utils.template(t,e)},e};var Utils=Utils||{};Utils.compare=function(e,t){var n=Utils.getFile("/static/tests/"+t);assert.equal(e,n)},Utils.template=function(e,t){Utils.template.tmpl_cache||(Utils.template.tmpl_cache={});if(!Utils.template.tmpl_cache[e]){var n="/static/templates",r=n+"/"+e,i=Utils.getFile(r);Utils.template.tmpl_cache[e]=_.template(i)}return Utils.template.tmpl_cache[e](t)},Utils.getFile=function(e){var t;return $.ajax({url:e,method:"GET",async:!1,success:function(e){t=e}}),t};